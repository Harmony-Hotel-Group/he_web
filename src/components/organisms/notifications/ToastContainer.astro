---
// src/components/organisms/notifications/ToastContainer.astro
---

<div
  id="toast-container"
  class="fixed top-5 right-5 z-[9999] w-full max-w-xs space-y-2"
>
</div>

<style>
  .toast {
    display: flex;
    align-items: center;
    padding: 1rem;
    gap: 1rem;
    background-color: white;
    border-radius: 0.5rem;
    box-shadow:
      0 10px 15px -3px rgb(0 0 0 / 0.1),
      0 4px 6px -4px rgb(0 0 0 / 0.1);
    opacity: 0;
    transform: translateX(100%);
    transition: all 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
  }

  .toast.show {
    opacity: 1;
    transform: translateX(0);
  }

  .toast.success {
    background-color: #f0fdf4;
    color: #14532d;
  }

  .toast.error {
    background-color: #fef2f2;
    color: #991b1b;
  }

  .toast-icon {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    width: 2rem;
    height: 2rem;
    border-radius: 0.5rem;
  }

  .toast.success .toast-icon {
    background-color: #dcfce7;
    color: #16a34a;
  }

  .toast.error .toast-icon {
    background-color: #fee2e2;
    color: #ef4444;
  }
</style>

<script>
  function showToast(message: string, type: "success" | "error" | "info" = "success") {
    const container = document.getElementById("toast-container");
    if (!container) return;

    const toastId = `toast-${Date.now()}`;
    const toast = document.createElement("div");
    toast.id = toastId;
    toast.className = `toast ${type}`;
    toast.setAttribute("role", "alert");

    const icons = {
      success: `<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg>`,
      error: `<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>`,
      info: `<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg>`,
    };

    toast.innerHTML = `
      <div class="toast-icon">${icons[type] || ""}</div>
      <div class="text-sm font-normal">${message}</div>
      <button type="button" class="ms-auto -mx-1.5 -my-1.5 bg-transparent text-gray-400 hover:text-gray-900 rounded-lg p-1.5 hover:bg-gray-100 inline-flex items-center justify-center h-8 w-8" aria-label="Close">
        <svg class="w-3 h-3" fill="none" viewBox="0 0 14 14"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/></svg>
      </button>
    `;

    container.appendChild(toast);

    setTimeout(() => toast.classList.add("show"), 100);

    const timeoutId = setTimeout(() => {
      toast.classList.remove("show");
      setTimeout(() => toast.remove(), 500);
    }, 5000);

    toast.querySelector("button")?.addEventListener("click", () => {
      clearTimeout(timeoutId);
      toast.classList.remove("show");
      setTimeout(() => toast.remove(), 500);
    });
  }

  window.showToast = showToast;
</script>
