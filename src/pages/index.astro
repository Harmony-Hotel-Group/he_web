---
import BaseLayout from '../layouts/BaseLayout.astro';
import { useTranslations } from '../i18n/translation';
import VisualCarousel from '../components/features/carousel/VisualCarousel.astro';
import { fetchData } from "../utils/apiService";
import InfoCard from '../components/ui/InfoCard.astro';
import PhotoCollage from '../components/ui/PhotoCollage.astro';

const lang = Astro.cookies.get('lang')?.value || 'es';
const t = useTranslations(lang);

const dataConfig = await fetchData('config');
const carouselResources = dataConfig?.carouselResources || [];

---

<BaseLayout titleKey="site.title" lang={lang} config={dataConfig}>
  <div class="relative w-full min-h-screen">
    <VisualCarousel resources={carouselResources} videoZoomScale={1.2} class="absolute inset-0" />
  </div>

  <div class="py-16">
    <!-- About Us Section -->
    {dataConfig?.aboutUs && (
      <section class="container mx-auto px-6 mb-24">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
          <!-- Left Column: Text -->
          <div class="text-center md:text-left">
            <h3 class="text-lg font-semibold text-accent mb-2">{dataConfig.aboutUs.subtitle[lang]}</h3>
            <h1 class="text-4xl font-bold text-primary mb-4">{dataConfig.aboutUs.mainTitle[lang]}</h1>
            <p class="text-gray-600 leading-relaxed mb-4">{dataConfig.aboutUs.welcomeParagraph[lang]}</p>
            <p class="text-gray-600 leading-relaxed">{dataConfig.aboutUs.commitmentParagraph[lang]}</p>
          </div>
          <!-- Right Column: Image Collage -->
          <div>
            <PhotoCollage images={dataConfig.aboutUs.images} />
          </div>
        </div>
      </section>
    )}

    <!-- Rooms Section -->
    {dataConfig?.roomTypes && (
      <section class="container mx-auto px-6 mb-16">
        <h2 class="text-3xl font-bold text-center text-primary mb-8">{t('nav.rooms')}</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          {dataConfig.roomTypes.map(roomType => (
            <InfoCard
              href={`/rooms/${roomType.id}`}
              imageSrc={roomType.src}
              imageAlt={roomType.name[lang]}
              title={roomType.name[lang]}
              description={t('home.explore_category')}
            />
          ))}
        </div>
      </section>
    )}

    <!-- Destinations Section -->
    {dataConfig?.destinationCategories && (
      <section class="container mx-auto px-6 mb-16">
        <h2 class="text-3xl font-bold text-center text-primary mb-8">{t('nav.destinations')}</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          {dataConfig.destinationCategories.map(category => (
            <InfoCard
              href={`/destinations/${category.id}`}
              imageSrc={category.src}
              imageAlt={category.name[lang]}
              title={category.name[lang]}
              description={t('home.explore_category')}
            />
          ))}
        </div>
      </section>
    )}

    <!-- Gastronomy Section -->
    {dataConfig?.gastronomyCategories && (
      <section class="container mx-auto px-6 mb-16">
        <h2 class="text-3xl font-bold text-center text-primary mb-8">{t('nav.gastronomy')}</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          {dataConfig.gastronomyCategories.map(category => (
            <InfoCard
              href={`/gastronomy/${category.id}`}
              imageSrc={category.src}
              imageAlt={category.name[lang]}
              title={category.name[lang]}
              description={t('home.explore_category')}
            />
          ))}
        </div>
      </section>
    )}

    <!-- Tours Section -->
    {dataConfig?.tourCategories && (
      <section class="container mx-auto px-6">
        <h2 class="text-3xl font-bold text-center text-primary mb-8">{t('nav.tours')}</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          {dataConfig.tourCategories.map(category => (
            <InfoCard
              href={`/tours/${category.id}`}
              imageSrc={category.src}
              imageAlt={category.name[lang]}
              title={category.name[lang]}
              description={t('home.explore_category')}
            />
          ))}
        </div>
      </section>
    )}
  </div>
</BaseLayout>
